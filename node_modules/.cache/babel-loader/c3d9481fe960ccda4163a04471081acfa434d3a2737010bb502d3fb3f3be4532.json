{"ast":null,"code":"var _excluded = [\"alignSelf\", \"autoPlay\", \"children\", \"controls\", \"gridArea\", \"loop\", \"margin\", \"messages\", \"mute\", \"onDurationChange\", \"onEnded\", \"onPause\", \"onPlay\", \"onTimeUpdate\", \"onVolumeChange\", \"skipInterval\"];\nfunction _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nfunction _objectWithoutPropertiesLoose(r, e) {\n  if (null == r) return {};\n  var t = {};\n  for (var n in r) if ({}.hasOwnProperty.call(r, n)) {\n    if (e.indexOf(n) >= 0) continue;\n    t[n] = r[n];\n  }\n  return t;\n}\nimport React, { forwardRef, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { AnnounceContext } from '../../contexts/AnnounceContext';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Menu } from '../Menu';\nimport { Meter } from '../Meter';\nimport { Stack } from '../Stack';\nimport { Text } from '../Text';\nimport { Keyboard } from '../Keyboard';\nimport { containsFocus, useForwardedRef } from '../../utils';\nimport { StyledVideo, StyledVideoContainer, StyledVideoControls, StyledVideoScrubber } from './StyledVideo';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { VideoPropTypes } from './propTypes';\nimport { useThemeValue } from '../../utils/useThemeValue';\n\n// Split the volume control into 6 segments. Empirically determined.\nvar VOLUME_STEP = 0.166667;\nvar formatTime = function formatTime(time) {\n  var minutes = Math.round(time / 60);\n  if (minutes < 10) {\n    minutes = \"0\" + minutes;\n  }\n  var seconds = Math.round(time) % 60;\n  if (seconds < 10) {\n    seconds = \"0\" + seconds;\n  }\n  return minutes + \":\" + seconds;\n};\nvar Video = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var alignSelf = _ref.alignSelf,\n    autoPlay = _ref.autoPlay,\n    children = _ref.children,\n    controlsProp = _ref.controls,\n    gridArea = _ref.gridArea,\n    loop = _ref.loop,\n    margin = _ref.margin,\n    messages = _ref.messages,\n    mute = _ref.mute,\n    _onDurationChange = _ref.onDurationChange,\n    _onEnded = _ref.onEnded,\n    _onPause = _ref.onPause,\n    _onPlay = _ref.onPlay,\n    _onTimeUpdate = _ref.onTimeUpdate,\n    _onVolumeChange = _ref.onVolumeChange,\n    skipInterval = _ref.skipInterval,\n    rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n  var theme = useThemeValue();\n  var _useContext = useContext(MessageContext),\n    format = _useContext.format;\n  var announce = useContext(AnnounceContext);\n  var _useState = useState([]),\n    captions = _useState[0],\n    setCaptions = _useState[1];\n  var _useState2 = useState(),\n    currentTime = _useState2[0],\n    setCurrentTime = _useState2[1];\n  var _useState3 = useState(),\n    duration = _useState3[0],\n    setDuration = _useState3[1];\n  var _useState4 = useState(),\n    percentagePlayed = _useState4[0],\n    setPercentagePlayed = _useState4[1];\n  var _useState5 = useState(false),\n    playing = _useState5[0],\n    setPlaying = _useState5[1];\n  var _useState6 = useState(false),\n    announceAudioDescription = _useState6[0],\n    setAnnounceAudioDescription = _useState6[1];\n  var _useState7 = useState(),\n    scrubTime = _useState7[0],\n    setScrubTime = _useState7[1];\n  var _useState8 = useState(),\n    volume = _useState8[0],\n    setVolume = _useState8[1];\n  var _useState9 = useState(false),\n    hasPlayed = _useState9[0],\n    setHasPlayed = _useState9[1];\n  var _useState10 = useState(),\n    interacting = _useState10[0],\n    setInteracting = _useState10[1];\n  var _useState11 = useState(),\n    height = _useState11[0],\n    setHeight = _useState11[1];\n  var _useState12 = useState(),\n    width = _useState12[0],\n    setWidth = _useState12[1];\n  var containerRef = useRef();\n  var scrubberRef = useRef();\n  var videoRef = useForwardedRef(ref);\n  var controls = useMemo(function () {\n    var result;\n    if (typeof controlsProp === 'string' || typeof controlsProp === 'boolean') {\n      result = {\n        items: ['volume', 'fullScreen'],\n        position: controlsProp\n      };\n    } else {\n      result = {\n        items: (controlsProp == null ? void 0 : controlsProp.items) || ['volume', 'fullScreen'],\n        position: (controlsProp == null ? void 0 : controlsProp.position) || 'over'\n      };\n    }\n    return result;\n  }, [controlsProp]);\n\n  // mute if needed\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video && mute) video.muted = true;\n  }, [mute, videoRef]);\n\n  // when the video is first rendered, set state from it where needed\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video) {\n      // hide all captioning to start with\n      var textTracks = video.textTracks;\n      for (var i = 0; i < textTracks.length; i += 1) {\n        textTracks[i].mode = 'hidden';\n      }\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      setVolume(videoRef.current.volume);\n    }\n  }, [videoRef]);\n\n  // turn off interacting after a while\n  useEffect(function () {\n    var timer = setTimeout(function () {\n      if (interacting && !containsFocus(containerRef.current)) {\n        setInteracting(false);\n      }\n    }, 3000);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [interacting]);\n\n  // track which audio description track is active\n  var _useState13 = useState(),\n    activeTrack = _useState13[0],\n    setActiveTrack = _useState13[1];\n  useLayoutEffect(function () {\n    var video = videoRef.current;\n    if (video) {\n      if (video.videoHeight) {\n        // set the size based on the video aspect ratio\n        var rect = video.getBoundingClientRect();\n        var ratio = rect.width / rect.height;\n        var videoRatio = video.videoWidth / video.videoHeight;\n        if (videoRatio > ratio) {\n          var nextHeight = rect.width / videoRatio;\n          if (nextHeight !== height) {\n            setHeight(nextHeight);\n            setWidth(undefined);\n          }\n        } else {\n          var nextWidth = rect.height * videoRatio;\n          if (nextWidth !== width) {\n            setHeight(undefined);\n            setWidth(nextWidth);\n          }\n        }\n      }\n\n      // remember the state of the text tracks for subsequent rendering\n      var textTracks = video.textTracks;\n      var nextCaptions = [];\n      var set = false;\n      // iterate through all of the tracks provided\n      var _loop = function _loop() {\n        var track = textTracks[i];\n        var active = track.mode === 'showing';\n        var getActiveTrack = function getActiveTrack(currentVideoTime) {\n          var nextActiveTrack;\n          for (var j = 0; j < track.cues.length; j += 1) {\n            var _track$cues$j, _track$cues$j2;\n            if (currentVideoTime > (track == null || (_track$cues$j = track.cues[j]) == null ? void 0 : _track$cues$j.startTime) && currentVideoTime < (track == null || (_track$cues$j2 = track.cues[j]) == null ? void 0 : _track$cues$j2.endTime)) {\n              var _track$cues$j3;\n              nextActiveTrack = track == null || (_track$cues$j3 = track.cues[j]) == null ? void 0 : _track$cues$j3.text;\n            }\n          }\n          return nextActiveTrack;\n        };\n\n        // track is an audio description\n        if (track.kind === 'descriptions') {\n          if (announceAudioDescription) {\n            video.ontimeupdate = function () {\n              var nextActiveTrack = getActiveTrack(video.currentTime);\n              if (activeTrack !== nextActiveTrack) {\n                if (nextActiveTrack) {\n                  announce(nextActiveTrack, 'assertive');\n                }\n                setActiveTrack(nextActiveTrack);\n              }\n            };\n          }\n        }\n\n        // otherwise treat as captions\n        else {\n          nextCaptions.push({\n            label: track.label,\n            active: active\n          });\n          if (!captions || !captions[i] || captions[i].active !== active) {\n            set = true;\n          }\n          if (set) {\n            setCaptions(nextCaptions);\n          }\n        }\n      };\n      for (var i = 0; i < textTracks.length; i += 1) {\n        _loop();\n      }\n    }\n  }, [activeTrack, announce, announceAudioDescription, captions, height, videoRef, width]);\n  var play = useCallback(function () {\n    return videoRef.current.play();\n  }, [videoRef]);\n  var pause = useCallback(function () {\n    return videoRef.current.pause();\n  }, [videoRef]);\n  var scrub = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      setScrubTime(duration * percent);\n    }\n  }, [duration]);\n  var seek = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      if (duration) videoRef.current.currentTime = duration * percent;\n    }\n  }, [duration, videoRef]);\n  var seekForward = useCallback(function () {\n    setInteracting(true);\n    videoRef.current.currentTime += skipInterval || theme.video.scrubber.interval;\n  }, [skipInterval, theme.video.scrubber.interval, videoRef]);\n  var seekBackward = useCallback(function () {\n    setInteracting(true);\n    videoRef.current.currentTime -= skipInterval || theme.video.scrubber.interval;\n  }, [skipInterval, theme.video.scrubber.interval, videoRef]);\n  var louder = useCallback(function () {\n    videoRef.current.volume += VOLUME_STEP;\n  }, [videoRef]);\n  var quieter = useCallback(function () {\n    videoRef.current.volume -= VOLUME_STEP;\n  }, [videoRef]);\n  var showCaptions = useCallback(function (index) {\n    var textTracks = videoRef.current.textTracks;\n    for (var i = 0; i < textTracks.length; i += 1) textTracks[i].mode = i === index ? 'showing' : 'hidden';\n  }, [videoRef]);\n  var fullscreen = useCallback(function () {\n    var video = videoRef.current;\n    if (video.requestFullscreen) {\n      video.requestFullscreen();\n    } else if (video.msRequestFullscreen) {\n      video.msRequestFullscreen();\n    } else if (video.mozRequestFullScreen) {\n      video.mozRequestFullScreen();\n    } else if (video.webkitRequestFullscreen) {\n      video.webkitRequestFullscreen();\n    } else {\n      console.warn(\"This browser doesn't support fullscreen.\");\n    }\n  }, [videoRef]);\n  var controlsElement;\n  if (controls != null && controls.position) {\n    var _controls$items;\n    var over = controls.position === 'over';\n    var background = over ? theme.video.controls && theme.video.controls.background || {\n      color: 'background-back',\n      opacity: 'strong',\n      dark: true\n    } : undefined;\n    var iconColor = over && (theme.video.icons.color || 'text');\n    var formattedTime = formatTime(scrubTime || currentTime || duration);\n    var Icons = {\n      ClosedCaption: theme.video.icons.closedCaption,\n      Configure: theme.video.icons.configure,\n      FullScreen: theme.video.icons.fullScreen,\n      Pause: theme.video.icons.pause,\n      Play: theme.video.icons.play,\n      ReduceVolume: theme.video.icons.reduceVolume,\n      Volume: theme.video.icons.volume,\n      Description: theme.video.icons.description\n    };\n    var captionControls = captions.map(function (caption, index) {\n      return {\n        icon: caption.label ? undefined : /*#__PURE__*/React.createElement(Icons.ClosedCaption, {\n          color: iconColor\n        }),\n        label: caption.label,\n        active: caption.active,\n        a11yTitle: caption.label || format({\n          id: 'video.captions',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          showCaptions(caption.active ? -1 : index);\n          var updatedCaptions = [];\n          for (var i = 0; i < captions.length; i += 1) {\n            updatedCaptions.push(captions[i]);\n            // set other captions to active=false\n            if (i !== index && updatedCaptions[i].active) updatedCaptions[i].active = false;\n            // set the currently selected captions to active\n            else if (i === index) updatedCaptions[i].active = !captions[index].active;\n          }\n          setCaptions(updatedCaptions);\n        }\n      };\n    });\n    var descriptionControls = {\n      icon: /*#__PURE__*/React.createElement(Icons.Description, {\n        color: iconColor\n      }),\n      a11yTitle: format({\n        id: 'video.audioDescriptions',\n        messages: messages\n      }),\n      active: announceAudioDescription,\n      onClick: function onClick() {\n        return setAnnounceAudioDescription(!announceAudioDescription);\n      }\n    };\n    var volumeControls = ['volume', 'reduceVolume'].map(function (control) {\n      return {\n        icon: control === 'volume' ? /*#__PURE__*/React.createElement(Icons.Volume, {\n          color: iconColor\n        }) : /*#__PURE__*/React.createElement(Icons.ReduceVolume, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: control === 'volume' ? 'video.volumeUp' : 'video.volumeDown',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          if (volume <= 1 - VOLUME_STEP && control === 'volume') {\n            return louder();\n          }\n          if (volume >= VOLUME_STEP && control === 'reduceVolume') {\n            return quieter();\n          }\n          return undefined;\n        },\n        close: false\n      };\n    });\n    var buttonProps = {\n      captions: captionControls,\n      descriptions: descriptionControls,\n      volume: volumeControls,\n      fullScreen: {\n        icon: /*#__PURE__*/React.createElement(Icons.FullScreen, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.fullScreen',\n          messages: messages\n        }),\n        onClick: fullscreen\n      },\n      pause: {\n        icon: /*#__PURE__*/React.createElement(Icons.Pause, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        }),\n        disabled: !playing,\n        onClick: pause\n      },\n      play: {\n        icon: /*#__PURE__*/React.createElement(Icons.Play, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        }),\n        disabled: playing,\n        onClick: play\n      }\n    };\n    var controlsMenuItems = [];\n    (_controls$items = controls.items) == null || _controls$items.map(function (item) {\n      if (item === 'volume') {\n        volumeControls.map(function (control) {\n          return controlsMenuItems.push(control);\n        });\n        return undefined;\n      }\n      if (item === 'captions' && typeof buttonProps[item] === 'object') {\n        for (var i = 0; i < buttonProps[item].length; i += 1) controlsMenuItems.push(buttonProps[item][i]);\n        return undefined;\n      }\n      if (item === 'descriptions') {\n        controlsMenuItems.push(buttonProps[item]);\n        return undefined;\n      }\n      if (typeof item === 'string') {\n        return controlsMenuItems.push(buttonProps[item]);\n      }\n      return controlsMenuItems.push(item);\n    });\n    controlsElement = /*#__PURE__*/React.createElement(StyledVideoControls, {\n      over: over,\n      active: !hasPlayed || controls.position === 'below' || over && interacting,\n      onBlur: function onBlur() {\n        if (!containsFocus(containerRef.current)) setInteracting(false);\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      justify: \"between\",\n      background: background\n    }, /*#__PURE__*/React.createElement(Button, {\n      icon: playing ? /*#__PURE__*/React.createElement(Icons.Pause, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        })\n      }) : /*#__PURE__*/React.createElement(Icons.Play, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        })\n      }),\n      hoverIndicator: \"background\",\n      onClick: playing ? pause : play,\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    }), /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      flex: true\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true\n    }, /*#__PURE__*/React.createElement(Stack, null, /*#__PURE__*/React.createElement(Meter, {\n      \"aria-label\": format({\n        id: 'video.progressMeter',\n        messages: messages\n      }),\n      background: over ? theme.video.scrubber && theme.video.scrubber.track && theme.video.scrubber.track.color || 'dark-3' : undefined,\n      size: \"full\",\n      thickness: \"small\",\n      values: [{\n        value: percentagePlayed || 0\n      }]\n    }), /*#__PURE__*/React.createElement(StyledVideoScrubber, {\n      \"aria-label\": format({\n        id: 'video.scrubber',\n        messages: messages\n      }),\n      ref: scrubberRef,\n      tabIndex: 0,\n      role: \"button\",\n      value: scrubTime ? Math.round(scrubTime / duration * 100) : undefined,\n      onMouseMove: scrub,\n      onMouseLeave: function onMouseLeave() {\n        return setScrubTime(undefined);\n      },\n      onClick: seek,\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    }))), /*#__PURE__*/React.createElement(Box, {\n      pad: {\n        horizontal: 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      margin: \"none\"\n    }, formattedTime))), /*#__PURE__*/React.createElement(Menu, {\n      icon: /*#__PURE__*/React.createElement(Icons.Configure, {\n        color: iconColor\n      }),\n      dropAlign: {\n        bottom: 'top',\n        right: 'right'\n      },\n      dropBackground: background,\n      messages: {\n        openMenu: format({\n          id: 'video.openMenu',\n          messages: messages\n        }),\n        closeMenu: format({\n          id: 'video.closeMenu',\n          messages: messages\n        })\n      },\n      items: [].concat(controlsMenuItems),\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    })));\n  }\n  var mouseEventListeners;\n  if ((controls == null ? void 0 : controls.position) === 'over') {\n    mouseEventListeners = {\n      onMouseEnter: function onMouseEnter() {\n        return setInteracting(true);\n      },\n      onMouseMove: function onMouseMove() {\n        return setInteracting(true);\n      },\n      onTouchStart: function onTouchStart() {\n        return setInteracting(true);\n      }\n    };\n  }\n  var style;\n  if (rest.fit === 'contain' && (controls == null ? void 0 : controls.position) === 'over') {\n    // constrain the size to fit the aspect ratio so the controls\n    // overlap correctly\n    if (width) {\n      style = {\n        width: width\n      };\n    } else if (height) {\n      style = {\n        height: height\n      };\n    }\n  }\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onLeft: seekBackward,\n    onRight: seekForward\n  }, /*#__PURE__*/React.createElement(StyledVideoContainer, _extends({\n    ref: containerRef\n  }, mouseEventListeners, {\n    alignSelf: alignSelf,\n    gridArea: gridArea,\n    margin: margin,\n    style: style,\n    tabIndex: \"-1\"\n  }), /*#__PURE__*/React.createElement(StyledVideo, _extends({}, rest, {\n    ref: videoRef,\n    onDurationChange: function onDurationChange(event) {\n      var video = videoRef.current;\n      setDuration(video.duration);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onDurationChange) _onDurationChange(event);\n    },\n    onEnded: function onEnded(event) {\n      setPlaying(false);\n      if (_onEnded) _onEnded(event);\n    },\n    onPause: function onPause(event) {\n      setPlaying(false);\n      if (_onPause) _onPause(event);\n    },\n    onPlay: function onPlay(event) {\n      setPlaying(true);\n      setHasPlayed(true);\n      if (_onPlay) _onPlay(event);\n    },\n    onTimeUpdate: function onTimeUpdate(event) {\n      var video = videoRef.current;\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onTimeUpdate) _onTimeUpdate(event);\n    },\n    onVolumeChange: function onVolumeChange(event) {\n      setVolume(videoRef.current.volume);\n      if (_onVolumeChange) _onVolumeChange(event);\n    },\n    autoPlay: autoPlay || false,\n    loop: loop || false\n  }), children), controlsElement));\n});\nVideo.displayName = 'Video';\nVideo.propTypes = VideoPropTypes;\nexport { Video };","map":{"version":3,"names":["_excluded","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","indexOf","React","forwardRef","useCallback","useContext","useEffect","useMemo","useRef","useState","useLayoutEffect","AnnounceContext","Box","Button","Menu","Meter","Stack","Text","Keyboard","containsFocus","useForwardedRef","StyledVideo","StyledVideoContainer","StyledVideoControls","StyledVideoScrubber","MessageContext","VideoPropTypes","useThemeValue","VOLUME_STEP","formatTime","time","minutes","Math","round","seconds","Video","_ref","ref","alignSelf","autoPlay","children","controlsProp","controls","gridArea","loop","margin","messages","mute","_onDurationChange","onDurationChange","_onEnded","onEnded","_onPause","onPause","_onPlay","onPlay","_onTimeUpdate","onTimeUpdate","_onVolumeChange","onVolumeChange","skipInterval","rest","theme","_useContext","format","announce","_useState","captions","setCaptions","_useState2","currentTime","setCurrentTime","_useState3","duration","setDuration","_useState4","percentagePlayed","setPercentagePlayed","_useState5","playing","setPlaying","_useState6","announceAudioDescription","setAnnounceAudioDescription","_useState7","scrubTime","setScrubTime","_useState8","volume","setVolume","_useState9","hasPlayed","setHasPlayed","_useState10","interacting","setInteracting","_useState11","height","setHeight","_useState12","width","setWidth","containerRef","scrubberRef","videoRef","result","items","position","video","current","muted","textTracks","i","mode","timer","setTimeout","clearTimeout","_useState13","activeTrack","setActiveTrack","videoHeight","rect","getBoundingClientRect","ratio","videoRatio","videoWidth","nextHeight","undefined","nextWidth","nextCaptions","set","_loop","track","active","getActiveTrack","currentVideoTime","nextActiveTrack","j","cues","_track$cues$j","_track$cues$j2","startTime","endTime","_track$cues$j3","text","kind","ontimeupdate","push","label","play","pause","scrub","event","scrubberRect","percent","clientX","left","seek","seekForward","scrubber","interval","seekBackward","louder","quieter","showCaptions","index","fullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","console","warn","controlsElement","_controls$items","over","background","color","opacity","dark","iconColor","icons","formattedTime","Icons","ClosedCaption","closedCaption","Configure","configure","FullScreen","fullScreen","Pause","Play","ReduceVolume","reduceVolume","Volume","Description","description","captionControls","map","caption","icon","createElement","a11yTitle","id","onClick","updatedCaptions","descriptionControls","volumeControls","control","close","buttonProps","descriptions","disabled","controlsMenuItems","item","onBlur","direction","align","justify","hoverIndicator","onFocus","flex","size","thickness","values","value","tabIndex","role","onMouseMove","onMouseLeave","pad","horizontal","dropAlign","bottom","right","dropBackground","openMenu","closeMenu","concat","mouseEventListeners","onMouseEnter","onTouchStart","style","fit","onLeft","onRight","displayName","propTypes"],"sources":["/home/uranus/portfolio/node_modules/grommet/es6/components/Video/Video.js"],"sourcesContent":["var _excluded = [\"alignSelf\", \"autoPlay\", \"children\", \"controls\", \"gridArea\", \"loop\", \"margin\", \"messages\", \"mute\", \"onDurationChange\", \"onEnded\", \"onPause\", \"onPlay\", \"onTimeUpdate\", \"onVolumeChange\", \"skipInterval\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\nimport React, { forwardRef, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { AnnounceContext } from '../../contexts/AnnounceContext';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Menu } from '../Menu';\nimport { Meter } from '../Meter';\nimport { Stack } from '../Stack';\nimport { Text } from '../Text';\nimport { Keyboard } from '../Keyboard';\nimport { containsFocus, useForwardedRef } from '../../utils';\nimport { StyledVideo, StyledVideoContainer, StyledVideoControls, StyledVideoScrubber } from './StyledVideo';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { VideoPropTypes } from './propTypes';\nimport { useThemeValue } from '../../utils/useThemeValue';\n\n// Split the volume control into 6 segments. Empirically determined.\nvar VOLUME_STEP = 0.166667;\nvar formatTime = function formatTime(time) {\n  var minutes = Math.round(time / 60);\n  if (minutes < 10) {\n    minutes = \"0\" + minutes;\n  }\n  var seconds = Math.round(time) % 60;\n  if (seconds < 10) {\n    seconds = \"0\" + seconds;\n  }\n  return minutes + \":\" + seconds;\n};\nvar Video = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var alignSelf = _ref.alignSelf,\n    autoPlay = _ref.autoPlay,\n    children = _ref.children,\n    controlsProp = _ref.controls,\n    gridArea = _ref.gridArea,\n    loop = _ref.loop,\n    margin = _ref.margin,\n    messages = _ref.messages,\n    mute = _ref.mute,\n    _onDurationChange = _ref.onDurationChange,\n    _onEnded = _ref.onEnded,\n    _onPause = _ref.onPause,\n    _onPlay = _ref.onPlay,\n    _onTimeUpdate = _ref.onTimeUpdate,\n    _onVolumeChange = _ref.onVolumeChange,\n    skipInterval = _ref.skipInterval,\n    rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n  var theme = useThemeValue();\n  var _useContext = useContext(MessageContext),\n    format = _useContext.format;\n  var announce = useContext(AnnounceContext);\n  var _useState = useState([]),\n    captions = _useState[0],\n    setCaptions = _useState[1];\n  var _useState2 = useState(),\n    currentTime = _useState2[0],\n    setCurrentTime = _useState2[1];\n  var _useState3 = useState(),\n    duration = _useState3[0],\n    setDuration = _useState3[1];\n  var _useState4 = useState(),\n    percentagePlayed = _useState4[0],\n    setPercentagePlayed = _useState4[1];\n  var _useState5 = useState(false),\n    playing = _useState5[0],\n    setPlaying = _useState5[1];\n  var _useState6 = useState(false),\n    announceAudioDescription = _useState6[0],\n    setAnnounceAudioDescription = _useState6[1];\n  var _useState7 = useState(),\n    scrubTime = _useState7[0],\n    setScrubTime = _useState7[1];\n  var _useState8 = useState(),\n    volume = _useState8[0],\n    setVolume = _useState8[1];\n  var _useState9 = useState(false),\n    hasPlayed = _useState9[0],\n    setHasPlayed = _useState9[1];\n  var _useState10 = useState(),\n    interacting = _useState10[0],\n    setInteracting = _useState10[1];\n  var _useState11 = useState(),\n    height = _useState11[0],\n    setHeight = _useState11[1];\n  var _useState12 = useState(),\n    width = _useState12[0],\n    setWidth = _useState12[1];\n  var containerRef = useRef();\n  var scrubberRef = useRef();\n  var videoRef = useForwardedRef(ref);\n  var controls = useMemo(function () {\n    var result;\n    if (typeof controlsProp === 'string' || typeof controlsProp === 'boolean') {\n      result = {\n        items: ['volume', 'fullScreen'],\n        position: controlsProp\n      };\n    } else {\n      result = {\n        items: (controlsProp == null ? void 0 : controlsProp.items) || ['volume', 'fullScreen'],\n        position: (controlsProp == null ? void 0 : controlsProp.position) || 'over'\n      };\n    }\n    return result;\n  }, [controlsProp]);\n\n  // mute if needed\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video && mute) video.muted = true;\n  }, [mute, videoRef]);\n\n  // when the video is first rendered, set state from it where needed\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video) {\n      // hide all captioning to start with\n      var textTracks = video.textTracks;\n      for (var i = 0; i < textTracks.length; i += 1) {\n        textTracks[i].mode = 'hidden';\n      }\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      setVolume(videoRef.current.volume);\n    }\n  }, [videoRef]);\n\n  // turn off interacting after a while\n  useEffect(function () {\n    var timer = setTimeout(function () {\n      if (interacting && !containsFocus(containerRef.current)) {\n        setInteracting(false);\n      }\n    }, 3000);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [interacting]);\n\n  // track which audio description track is active\n  var _useState13 = useState(),\n    activeTrack = _useState13[0],\n    setActiveTrack = _useState13[1];\n  useLayoutEffect(function () {\n    var video = videoRef.current;\n    if (video) {\n      if (video.videoHeight) {\n        // set the size based on the video aspect ratio\n        var rect = video.getBoundingClientRect();\n        var ratio = rect.width / rect.height;\n        var videoRatio = video.videoWidth / video.videoHeight;\n        if (videoRatio > ratio) {\n          var nextHeight = rect.width / videoRatio;\n          if (nextHeight !== height) {\n            setHeight(nextHeight);\n            setWidth(undefined);\n          }\n        } else {\n          var nextWidth = rect.height * videoRatio;\n          if (nextWidth !== width) {\n            setHeight(undefined);\n            setWidth(nextWidth);\n          }\n        }\n      }\n\n      // remember the state of the text tracks for subsequent rendering\n      var textTracks = video.textTracks;\n      var nextCaptions = [];\n      var set = false;\n      // iterate through all of the tracks provided\n      var _loop = function _loop() {\n        var track = textTracks[i];\n        var active = track.mode === 'showing';\n        var getActiveTrack = function getActiveTrack(currentVideoTime) {\n          var nextActiveTrack;\n          for (var j = 0; j < track.cues.length; j += 1) {\n            var _track$cues$j, _track$cues$j2;\n            if (currentVideoTime > (track == null || (_track$cues$j = track.cues[j]) == null ? void 0 : _track$cues$j.startTime) && currentVideoTime < (track == null || (_track$cues$j2 = track.cues[j]) == null ? void 0 : _track$cues$j2.endTime)) {\n              var _track$cues$j3;\n              nextActiveTrack = track == null || (_track$cues$j3 = track.cues[j]) == null ? void 0 : _track$cues$j3.text;\n            }\n          }\n          return nextActiveTrack;\n        };\n\n        // track is an audio description\n        if (track.kind === 'descriptions') {\n          if (announceAudioDescription) {\n            video.ontimeupdate = function () {\n              var nextActiveTrack = getActiveTrack(video.currentTime);\n              if (activeTrack !== nextActiveTrack) {\n                if (nextActiveTrack) {\n                  announce(nextActiveTrack, 'assertive');\n                }\n                setActiveTrack(nextActiveTrack);\n              }\n            };\n          }\n        }\n\n        // otherwise treat as captions\n        else {\n          nextCaptions.push({\n            label: track.label,\n            active: active\n          });\n          if (!captions || !captions[i] || captions[i].active !== active) {\n            set = true;\n          }\n          if (set) {\n            setCaptions(nextCaptions);\n          }\n        }\n      };\n      for (var i = 0; i < textTracks.length; i += 1) {\n        _loop();\n      }\n    }\n  }, [activeTrack, announce, announceAudioDescription, captions, height, videoRef, width]);\n  var play = useCallback(function () {\n    return videoRef.current.play();\n  }, [videoRef]);\n  var pause = useCallback(function () {\n    return videoRef.current.pause();\n  }, [videoRef]);\n  var scrub = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      setScrubTime(duration * percent);\n    }\n  }, [duration]);\n  var seek = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      if (duration) videoRef.current.currentTime = duration * percent;\n    }\n  }, [duration, videoRef]);\n  var seekForward = useCallback(function () {\n    setInteracting(true);\n    videoRef.current.currentTime += skipInterval || theme.video.scrubber.interval;\n  }, [skipInterval, theme.video.scrubber.interval, videoRef]);\n  var seekBackward = useCallback(function () {\n    setInteracting(true);\n    videoRef.current.currentTime -= skipInterval || theme.video.scrubber.interval;\n  }, [skipInterval, theme.video.scrubber.interval, videoRef]);\n  var louder = useCallback(function () {\n    videoRef.current.volume += VOLUME_STEP;\n  }, [videoRef]);\n  var quieter = useCallback(function () {\n    videoRef.current.volume -= VOLUME_STEP;\n  }, [videoRef]);\n  var showCaptions = useCallback(function (index) {\n    var textTracks = videoRef.current.textTracks;\n    for (var i = 0; i < textTracks.length; i += 1) textTracks[i].mode = i === index ? 'showing' : 'hidden';\n  }, [videoRef]);\n  var fullscreen = useCallback(function () {\n    var video = videoRef.current;\n    if (video.requestFullscreen) {\n      video.requestFullscreen();\n    } else if (video.msRequestFullscreen) {\n      video.msRequestFullscreen();\n    } else if (video.mozRequestFullScreen) {\n      video.mozRequestFullScreen();\n    } else if (video.webkitRequestFullscreen) {\n      video.webkitRequestFullscreen();\n    } else {\n      console.warn(\"This browser doesn't support fullscreen.\");\n    }\n  }, [videoRef]);\n  var controlsElement;\n  if (controls != null && controls.position) {\n    var _controls$items;\n    var over = controls.position === 'over';\n    var background = over ? theme.video.controls && theme.video.controls.background || {\n      color: 'background-back',\n      opacity: 'strong',\n      dark: true\n    } : undefined;\n    var iconColor = over && (theme.video.icons.color || 'text');\n    var formattedTime = formatTime(scrubTime || currentTime || duration);\n    var Icons = {\n      ClosedCaption: theme.video.icons.closedCaption,\n      Configure: theme.video.icons.configure,\n      FullScreen: theme.video.icons.fullScreen,\n      Pause: theme.video.icons.pause,\n      Play: theme.video.icons.play,\n      ReduceVolume: theme.video.icons.reduceVolume,\n      Volume: theme.video.icons.volume,\n      Description: theme.video.icons.description\n    };\n    var captionControls = captions.map(function (caption, index) {\n      return {\n        icon: caption.label ? undefined : /*#__PURE__*/React.createElement(Icons.ClosedCaption, {\n          color: iconColor\n        }),\n        label: caption.label,\n        active: caption.active,\n        a11yTitle: caption.label || format({\n          id: 'video.captions',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          showCaptions(caption.active ? -1 : index);\n          var updatedCaptions = [];\n          for (var i = 0; i < captions.length; i += 1) {\n            updatedCaptions.push(captions[i]);\n            // set other captions to active=false\n            if (i !== index && updatedCaptions[i].active) updatedCaptions[i].active = false;\n            // set the currently selected captions to active\n            else if (i === index) updatedCaptions[i].active = !captions[index].active;\n          }\n          setCaptions(updatedCaptions);\n        }\n      };\n    });\n    var descriptionControls = {\n      icon: /*#__PURE__*/React.createElement(Icons.Description, {\n        color: iconColor\n      }),\n      a11yTitle: format({\n        id: 'video.audioDescriptions',\n        messages: messages\n      }),\n      active: announceAudioDescription,\n      onClick: function onClick() {\n        return setAnnounceAudioDescription(!announceAudioDescription);\n      }\n    };\n    var volumeControls = ['volume', 'reduceVolume'].map(function (control) {\n      return {\n        icon: control === 'volume' ? /*#__PURE__*/React.createElement(Icons.Volume, {\n          color: iconColor\n        }) : /*#__PURE__*/React.createElement(Icons.ReduceVolume, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: control === 'volume' ? 'video.volumeUp' : 'video.volumeDown',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          if (volume <= 1 - VOLUME_STEP && control === 'volume') {\n            return louder();\n          }\n          if (volume >= VOLUME_STEP && control === 'reduceVolume') {\n            return quieter();\n          }\n          return undefined;\n        },\n        close: false\n      };\n    });\n    var buttonProps = {\n      captions: captionControls,\n      descriptions: descriptionControls,\n      volume: volumeControls,\n      fullScreen: {\n        icon: /*#__PURE__*/React.createElement(Icons.FullScreen, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.fullScreen',\n          messages: messages\n        }),\n        onClick: fullscreen\n      },\n      pause: {\n        icon: /*#__PURE__*/React.createElement(Icons.Pause, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        }),\n        disabled: !playing,\n        onClick: pause\n      },\n      play: {\n        icon: /*#__PURE__*/React.createElement(Icons.Play, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        }),\n        disabled: playing,\n        onClick: play\n      }\n    };\n    var controlsMenuItems = [];\n    (_controls$items = controls.items) == null || _controls$items.map(function (item) {\n      if (item === 'volume') {\n        volumeControls.map(function (control) {\n          return controlsMenuItems.push(control);\n        });\n        return undefined;\n      }\n      if (item === 'captions' && typeof buttonProps[item] === 'object') {\n        for (var i = 0; i < buttonProps[item].length; i += 1) controlsMenuItems.push(buttonProps[item][i]);\n        return undefined;\n      }\n      if (item === 'descriptions') {\n        controlsMenuItems.push(buttonProps[item]);\n        return undefined;\n      }\n      if (typeof item === 'string') {\n        return controlsMenuItems.push(buttonProps[item]);\n      }\n      return controlsMenuItems.push(item);\n    });\n    controlsElement = /*#__PURE__*/React.createElement(StyledVideoControls, {\n      over: over,\n      active: !hasPlayed || controls.position === 'below' || over && interacting,\n      onBlur: function onBlur() {\n        if (!containsFocus(containerRef.current)) setInteracting(false);\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      justify: \"between\",\n      background: background\n    }, /*#__PURE__*/React.createElement(Button, {\n      icon: playing ? /*#__PURE__*/React.createElement(Icons.Pause, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        })\n      }) : /*#__PURE__*/React.createElement(Icons.Play, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        })\n      }),\n      hoverIndicator: \"background\",\n      onClick: playing ? pause : play,\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    }), /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      flex: true\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true\n    }, /*#__PURE__*/React.createElement(Stack, null, /*#__PURE__*/React.createElement(Meter, {\n      \"aria-label\": format({\n        id: 'video.progressMeter',\n        messages: messages\n      }),\n      background: over ? theme.video.scrubber && theme.video.scrubber.track && theme.video.scrubber.track.color || 'dark-3' : undefined,\n      size: \"full\",\n      thickness: \"small\",\n      values: [{\n        value: percentagePlayed || 0\n      }]\n    }), /*#__PURE__*/React.createElement(StyledVideoScrubber, {\n      \"aria-label\": format({\n        id: 'video.scrubber',\n        messages: messages\n      }),\n      ref: scrubberRef,\n      tabIndex: 0,\n      role: \"button\",\n      value: scrubTime ? Math.round(scrubTime / duration * 100) : undefined,\n      onMouseMove: scrub,\n      onMouseLeave: function onMouseLeave() {\n        return setScrubTime(undefined);\n      },\n      onClick: seek,\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    }))), /*#__PURE__*/React.createElement(Box, {\n      pad: {\n        horizontal: 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      margin: \"none\"\n    }, formattedTime))), /*#__PURE__*/React.createElement(Menu, {\n      icon: /*#__PURE__*/React.createElement(Icons.Configure, {\n        color: iconColor\n      }),\n      dropAlign: {\n        bottom: 'top',\n        right: 'right'\n      },\n      dropBackground: background,\n      messages: {\n        openMenu: format({\n          id: 'video.openMenu',\n          messages: messages\n        }),\n        closeMenu: format({\n          id: 'video.closeMenu',\n          messages: messages\n        })\n      },\n      items: [].concat(controlsMenuItems),\n      onFocus: function onFocus() {\n        return setInteracting(true);\n      }\n    })));\n  }\n  var mouseEventListeners;\n  if ((controls == null ? void 0 : controls.position) === 'over') {\n    mouseEventListeners = {\n      onMouseEnter: function onMouseEnter() {\n        return setInteracting(true);\n      },\n      onMouseMove: function onMouseMove() {\n        return setInteracting(true);\n      },\n      onTouchStart: function onTouchStart() {\n        return setInteracting(true);\n      }\n    };\n  }\n  var style;\n  if (rest.fit === 'contain' && (controls == null ? void 0 : controls.position) === 'over') {\n    // constrain the size to fit the aspect ratio so the controls\n    // overlap correctly\n    if (width) {\n      style = {\n        width: width\n      };\n    } else if (height) {\n      style = {\n        height: height\n      };\n    }\n  }\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onLeft: seekBackward,\n    onRight: seekForward\n  }, /*#__PURE__*/React.createElement(StyledVideoContainer, _extends({\n    ref: containerRef\n  }, mouseEventListeners, {\n    alignSelf: alignSelf,\n    gridArea: gridArea,\n    margin: margin,\n    style: style,\n    tabIndex: \"-1\"\n  }), /*#__PURE__*/React.createElement(StyledVideo, _extends({}, rest, {\n    ref: videoRef,\n    onDurationChange: function onDurationChange(event) {\n      var video = videoRef.current;\n      setDuration(video.duration);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onDurationChange) _onDurationChange(event);\n    },\n    onEnded: function onEnded(event) {\n      setPlaying(false);\n      if (_onEnded) _onEnded(event);\n    },\n    onPause: function onPause(event) {\n      setPlaying(false);\n      if (_onPause) _onPause(event);\n    },\n    onPlay: function onPlay(event) {\n      setPlaying(true);\n      setHasPlayed(true);\n      if (_onPlay) _onPlay(event);\n    },\n    onTimeUpdate: function onTimeUpdate(event) {\n      var video = videoRef.current;\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onTimeUpdate) _onTimeUpdate(event);\n    },\n    onVolumeChange: function onVolumeChange(event) {\n      setVolume(videoRef.current.volume);\n      if (_onVolumeChange) _onVolumeChange(event);\n    },\n    autoPlay: autoPlay || false,\n    loop: loop || false\n  }), children), controlsElement));\n});\nVideo.displayName = 'Video';\nVideo.propTypes = VideoPropTypes;\nexport { Video };"],"mappings":"AAAA,IAAIA,SAAS,GAAG,CAAC,WAAW,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,MAAM,EAAE,kBAAkB,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAE,cAAc,EAAE,gBAAgB,EAAE,cAAc,CAAC;AACzN,SAASC,QAAQA,CAAA,EAAG;EAAE,OAAOA,QAAQ,GAAGC,MAAM,CAACC,MAAM,GAAGD,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,CAAC,GAAG,UAAUC,CAAC,EAAE;IAAE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEF,CAAC,EAAE,EAAE;MAAE,IAAIG,CAAC,GAAGF,SAAS,CAACD,CAAC,CAAC;MAAE,KAAK,IAAII,CAAC,IAAID,CAAC,EAAE,CAAC,CAAC,CAAC,EAAEE,cAAc,CAACC,IAAI,CAACH,CAAC,EAAEC,CAAC,CAAC,KAAKL,CAAC,CAACK,CAAC,CAAC,GAAGD,CAAC,CAACC,CAAC,CAAC,CAAC;IAAE;IAAE,OAAOL,CAAC;EAAE,CAAC,EAAEJ,QAAQ,CAACY,KAAK,CAAC,IAAI,EAAEN,SAAS,CAAC;AAAE;AACnR,SAASO,6BAA6BA,CAACJ,CAAC,EAAEJ,CAAC,EAAE;EAAE,IAAI,IAAI,IAAII,CAAC,EAAE,OAAO,CAAC,CAAC;EAAE,IAAID,CAAC,GAAG,CAAC,CAAC;EAAE,KAAK,IAAIJ,CAAC,IAAIK,CAAC,EAAE,IAAI,CAAC,CAAC,CAACC,cAAc,CAACC,IAAI,CAACF,CAAC,EAAEL,CAAC,CAAC,EAAE;IAAE,IAAIC,CAAC,CAACS,OAAO,CAACV,CAAC,CAAC,IAAI,CAAC,EAAE;IAAUI,CAAC,CAACJ,CAAC,CAAC,GAAGK,CAAC,CAACL,CAAC,CAAC;EAAE;EAAE,OAAOI,CAAC;AAAE;AACpM,OAAOO,KAAK,IAAIC,UAAU,EAAEC,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,OAAO,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACxG,SAASC,eAAe,QAAQ,0CAA0C;AAC1E,SAASC,eAAe,QAAQ,gCAAgC;AAChE,SAASC,GAAG,QAAQ,QAAQ;AAC5B,SAASC,MAAM,QAAQ,WAAW;AAClC,SAASC,IAAI,QAAQ,SAAS;AAC9B,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,IAAI,QAAQ,SAAS;AAC9B,SAASC,QAAQ,QAAQ,aAAa;AACtC,SAASC,aAAa,EAAEC,eAAe,QAAQ,aAAa;AAC5D,SAASC,WAAW,EAAEC,oBAAoB,EAAEC,mBAAmB,EAAEC,mBAAmB,QAAQ,eAAe;AAC3G,SAASC,cAAc,QAAQ,+BAA+B;AAC9D,SAASC,cAAc,QAAQ,aAAa;AAC5C,SAASC,aAAa,QAAQ,2BAA2B;;AAEzD;AACA,IAAIC,WAAW,GAAG,QAAQ;AAC1B,IAAIC,UAAU,GAAG,SAASA,UAAUA,CAACC,IAAI,EAAE;EACzC,IAAIC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,GAAG,EAAE,CAAC;EACnC,IAAIC,OAAO,GAAG,EAAE,EAAE;IAChBA,OAAO,GAAG,GAAG,GAAGA,OAAO;EACzB;EACA,IAAIG,OAAO,GAAGF,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,EAAE;EACnC,IAAII,OAAO,GAAG,EAAE,EAAE;IAChBA,OAAO,GAAG,GAAG,GAAGA,OAAO;EACzB;EACA,OAAOH,OAAO,GAAG,GAAG,GAAGG,OAAO;AAChC,CAAC;AACD,IAAIC,KAAK,GAAG,aAAahC,UAAU,CAAC,UAAUiC,IAAI,EAAEC,GAAG,EAAE;EACvD,IAAIC,SAAS,GAAGF,IAAI,CAACE,SAAS;IAC5BC,QAAQ,GAAGH,IAAI,CAACG,QAAQ;IACxBC,QAAQ,GAAGJ,IAAI,CAACI,QAAQ;IACxBC,YAAY,GAAGL,IAAI,CAACM,QAAQ;IAC5BC,QAAQ,GAAGP,IAAI,CAACO,QAAQ;IACxBC,IAAI,GAAGR,IAAI,CAACQ,IAAI;IAChBC,MAAM,GAAGT,IAAI,CAACS,MAAM;IACpBC,QAAQ,GAAGV,IAAI,CAACU,QAAQ;IACxBC,IAAI,GAAGX,IAAI,CAACW,IAAI;IAChBC,iBAAiB,GAAGZ,IAAI,CAACa,gBAAgB;IACzCC,QAAQ,GAAGd,IAAI,CAACe,OAAO;IACvBC,QAAQ,GAAGhB,IAAI,CAACiB,OAAO;IACvBC,OAAO,GAAGlB,IAAI,CAACmB,MAAM;IACrBC,aAAa,GAAGpB,IAAI,CAACqB,YAAY;IACjCC,eAAe,GAAGtB,IAAI,CAACuB,cAAc;IACrCC,YAAY,GAAGxB,IAAI,CAACwB,YAAY;IAChCC,IAAI,GAAG7D,6BAA6B,CAACoC,IAAI,EAAElD,SAAS,CAAC;EACvD,IAAI4E,KAAK,GAAGnC,aAAa,CAAC,CAAC;EAC3B,IAAIoC,WAAW,GAAG1D,UAAU,CAACoB,cAAc,CAAC;IAC1CuC,MAAM,GAAGD,WAAW,CAACC,MAAM;EAC7B,IAAIC,QAAQ,GAAG5D,UAAU,CAACM,eAAe,CAAC;EAC1C,IAAIuD,SAAS,GAAGzD,QAAQ,CAAC,EAAE,CAAC;IAC1B0D,QAAQ,GAAGD,SAAS,CAAC,CAAC,CAAC;IACvBE,WAAW,GAAGF,SAAS,CAAC,CAAC,CAAC;EAC5B,IAAIG,UAAU,GAAG5D,QAAQ,CAAC,CAAC;IACzB6D,WAAW,GAAGD,UAAU,CAAC,CAAC,CAAC;IAC3BE,cAAc,GAAGF,UAAU,CAAC,CAAC,CAAC;EAChC,IAAIG,UAAU,GAAG/D,QAAQ,CAAC,CAAC;IACzBgE,QAAQ,GAAGD,UAAU,CAAC,CAAC,CAAC;IACxBE,WAAW,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC7B,IAAIG,UAAU,GAAGlE,QAAQ,CAAC,CAAC;IACzBmE,gBAAgB,GAAGD,UAAU,CAAC,CAAC,CAAC;IAChCE,mBAAmB,GAAGF,UAAU,CAAC,CAAC,CAAC;EACrC,IAAIG,UAAU,GAAGrE,QAAQ,CAAC,KAAK,CAAC;IAC9BsE,OAAO,GAAGD,UAAU,CAAC,CAAC,CAAC;IACvBE,UAAU,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC5B,IAAIG,UAAU,GAAGxE,QAAQ,CAAC,KAAK,CAAC;IAC9ByE,wBAAwB,GAAGD,UAAU,CAAC,CAAC,CAAC;IACxCE,2BAA2B,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC7C,IAAIG,UAAU,GAAG3E,QAAQ,CAAC,CAAC;IACzB4E,SAAS,GAAGD,UAAU,CAAC,CAAC,CAAC;IACzBE,YAAY,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC9B,IAAIG,UAAU,GAAG9E,QAAQ,CAAC,CAAC;IACzB+E,MAAM,GAAGD,UAAU,CAAC,CAAC,CAAC;IACtBE,SAAS,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC3B,IAAIG,UAAU,GAAGjF,QAAQ,CAAC,KAAK,CAAC;IAC9BkF,SAAS,GAAGD,UAAU,CAAC,CAAC,CAAC;IACzBE,YAAY,GAAGF,UAAU,CAAC,CAAC,CAAC;EAC9B,IAAIG,WAAW,GAAGpF,QAAQ,CAAC,CAAC;IAC1BqF,WAAW,GAAGD,WAAW,CAAC,CAAC,CAAC;IAC5BE,cAAc,GAAGF,WAAW,CAAC,CAAC,CAAC;EACjC,IAAIG,WAAW,GAAGvF,QAAQ,CAAC,CAAC;IAC1BwF,MAAM,GAAGD,WAAW,CAAC,CAAC,CAAC;IACvBE,SAAS,GAAGF,WAAW,CAAC,CAAC,CAAC;EAC5B,IAAIG,WAAW,GAAG1F,QAAQ,CAAC,CAAC;IAC1B2F,KAAK,GAAGD,WAAW,CAAC,CAAC,CAAC;IACtBE,QAAQ,GAAGF,WAAW,CAAC,CAAC,CAAC;EAC3B,IAAIG,YAAY,GAAG9F,MAAM,CAAC,CAAC;EAC3B,IAAI+F,WAAW,GAAG/F,MAAM,CAAC,CAAC;EAC1B,IAAIgG,QAAQ,GAAGpF,eAAe,CAACiB,GAAG,CAAC;EACnC,IAAIK,QAAQ,GAAGnC,OAAO,CAAC,YAAY;IACjC,IAAIkG,MAAM;IACV,IAAI,OAAOhE,YAAY,KAAK,QAAQ,IAAI,OAAOA,YAAY,KAAK,SAAS,EAAE;MACzEgE,MAAM,GAAG;QACPC,KAAK,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC;QAC/BC,QAAQ,EAAElE;MACZ,CAAC;IACH,CAAC,MAAM;MACLgE,MAAM,GAAG;QACPC,KAAK,EAAE,CAACjE,YAAY,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACiE,KAAK,KAAK,CAAC,QAAQ,EAAE,YAAY,CAAC;QACvFC,QAAQ,EAAE,CAAClE,YAAY,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACkE,QAAQ,KAAK;MACvE,CAAC;IACH;IACA,OAAOF,MAAM;EACf,CAAC,EAAE,CAAChE,YAAY,CAAC,CAAC;;EAElB;EACAnC,SAAS,CAAC,YAAY;IACpB,IAAIsG,KAAK,GAAGJ,QAAQ,CAACK,OAAO;IAC5B,IAAID,KAAK,IAAI7D,IAAI,EAAE6D,KAAK,CAACE,KAAK,GAAG,IAAI;EACvC,CAAC,EAAE,CAAC/D,IAAI,EAAEyD,QAAQ,CAAC,CAAC;;EAEpB;EACAlG,SAAS,CAAC,YAAY;IACpB,IAAIsG,KAAK,GAAGJ,QAAQ,CAACK,OAAO;IAC5B,IAAID,KAAK,EAAE;MACT;MACA,IAAIG,UAAU,GAAGH,KAAK,CAACG,UAAU;MACjC,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,UAAU,CAACrH,MAAM,EAAEsH,CAAC,IAAI,CAAC,EAAE;QAC7CD,UAAU,CAACC,CAAC,CAAC,CAACC,IAAI,GAAG,QAAQ;MAC/B;MACA1C,cAAc,CAACqC,KAAK,CAACtC,WAAW,CAAC;MACjCO,mBAAmB,CAAC+B,KAAK,CAACtC,WAAW,GAAGsC,KAAK,CAACnC,QAAQ,GAAG,GAAG,CAAC;MAC7DgB,SAAS,CAACe,QAAQ,CAACK,OAAO,CAACrB,MAAM,CAAC;IACpC;EACF,CAAC,EAAE,CAACgB,QAAQ,CAAC,CAAC;;EAEd;EACAlG,SAAS,CAAC,YAAY;IACpB,IAAI4G,KAAK,GAAGC,UAAU,CAAC,YAAY;MACjC,IAAIrB,WAAW,IAAI,CAAC3E,aAAa,CAACmF,YAAY,CAACO,OAAO,CAAC,EAAE;QACvDd,cAAc,CAAC,KAAK,CAAC;MACvB;IACF,CAAC,EAAE,IAAI,CAAC;IACR,OAAO,YAAY;MACjB,OAAOqB,YAAY,CAACF,KAAK,CAAC;IAC5B,CAAC;EACH,CAAC,EAAE,CAACpB,WAAW,CAAC,CAAC;;EAEjB;EACA,IAAIuB,WAAW,GAAG5G,QAAQ,CAAC,CAAC;IAC1B6G,WAAW,GAAGD,WAAW,CAAC,CAAC,CAAC;IAC5BE,cAAc,GAAGF,WAAW,CAAC,CAAC,CAAC;EACjC3G,eAAe,CAAC,YAAY;IAC1B,IAAIkG,KAAK,GAAGJ,QAAQ,CAACK,OAAO;IAC5B,IAAID,KAAK,EAAE;MACT,IAAIA,KAAK,CAACY,WAAW,EAAE;QACrB;QACA,IAAIC,IAAI,GAAGb,KAAK,CAACc,qBAAqB,CAAC,CAAC;QACxC,IAAIC,KAAK,GAAGF,IAAI,CAACrB,KAAK,GAAGqB,IAAI,CAACxB,MAAM;QACpC,IAAI2B,UAAU,GAAGhB,KAAK,CAACiB,UAAU,GAAGjB,KAAK,CAACY,WAAW;QACrD,IAAII,UAAU,GAAGD,KAAK,EAAE;UACtB,IAAIG,UAAU,GAAGL,IAAI,CAACrB,KAAK,GAAGwB,UAAU;UACxC,IAAIE,UAAU,KAAK7B,MAAM,EAAE;YACzBC,SAAS,CAAC4B,UAAU,CAAC;YACrBzB,QAAQ,CAAC0B,SAAS,CAAC;UACrB;QACF,CAAC,MAAM;UACL,IAAIC,SAAS,GAAGP,IAAI,CAACxB,MAAM,GAAG2B,UAAU;UACxC,IAAII,SAAS,KAAK5B,KAAK,EAAE;YACvBF,SAAS,CAAC6B,SAAS,CAAC;YACpB1B,QAAQ,CAAC2B,SAAS,CAAC;UACrB;QACF;MACF;;MAEA;MACA,IAAIjB,UAAU,GAAGH,KAAK,CAACG,UAAU;MACjC,IAAIkB,YAAY,GAAG,EAAE;MACrB,IAAIC,GAAG,GAAG,KAAK;MACf;MACA,IAAIC,KAAK,GAAG,SAASA,KAAKA,CAAA,EAAG;QAC3B,IAAIC,KAAK,GAAGrB,UAAU,CAACC,CAAC,CAAC;QACzB,IAAIqB,MAAM,GAAGD,KAAK,CAACnB,IAAI,KAAK,SAAS;QACrC,IAAIqB,cAAc,GAAG,SAASA,cAAcA,CAACC,gBAAgB,EAAE;UAC7D,IAAIC,eAAe;UACnB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,KAAK,CAACM,IAAI,CAAChJ,MAAM,EAAE+I,CAAC,IAAI,CAAC,EAAE;YAC7C,IAAIE,aAAa,EAAEC,cAAc;YACjC,IAAIL,gBAAgB,IAAIH,KAAK,IAAI,IAAI,IAAI,CAACO,aAAa,GAAGP,KAAK,CAACM,IAAI,CAACD,CAAC,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGE,aAAa,CAACE,SAAS,CAAC,IAAIN,gBAAgB,IAAIH,KAAK,IAAI,IAAI,IAAI,CAACQ,cAAc,GAAGR,KAAK,CAACM,IAAI,CAACD,CAAC,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGG,cAAc,CAACE,OAAO,CAAC,EAAE;cACxO,IAAIC,cAAc;cAClBP,eAAe,GAAGJ,KAAK,IAAI,IAAI,IAAI,CAACW,cAAc,GAAGX,KAAK,CAACM,IAAI,CAACD,CAAC,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGM,cAAc,CAACC,IAAI;YAC5G;UACF;UACA,OAAOR,eAAe;QACxB,CAAC;;QAED;QACA,IAAIJ,KAAK,CAACa,IAAI,KAAK,cAAc,EAAE;UACjC,IAAI/D,wBAAwB,EAAE;YAC5B0B,KAAK,CAACsC,YAAY,GAAG,YAAY;cAC/B,IAAIV,eAAe,GAAGF,cAAc,CAAC1B,KAAK,CAACtC,WAAW,CAAC;cACvD,IAAIgD,WAAW,KAAKkB,eAAe,EAAE;gBACnC,IAAIA,eAAe,EAAE;kBACnBvE,QAAQ,CAACuE,eAAe,EAAE,WAAW,CAAC;gBACxC;gBACAjB,cAAc,CAACiB,eAAe,CAAC;cACjC;YACF,CAAC;UACH;QACF;;QAEA;QAAA,KACK;UACHP,YAAY,CAACkB,IAAI,CAAC;YAChBC,KAAK,EAAEhB,KAAK,CAACgB,KAAK;YAClBf,MAAM,EAAEA;UACV,CAAC,CAAC;UACF,IAAI,CAAClE,QAAQ,IAAI,CAACA,QAAQ,CAAC6C,CAAC,CAAC,IAAI7C,QAAQ,CAAC6C,CAAC,CAAC,CAACqB,MAAM,KAAKA,MAAM,EAAE;YAC9DH,GAAG,GAAG,IAAI;UACZ;UACA,IAAIA,GAAG,EAAE;YACP9D,WAAW,CAAC6D,YAAY,CAAC;UAC3B;QACF;MACF,CAAC;MACD,KAAK,IAAIjB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,UAAU,CAACrH,MAAM,EAAEsH,CAAC,IAAI,CAAC,EAAE;QAC7CmB,KAAK,CAAC,CAAC;MACT;IACF;EACF,CAAC,EAAE,CAACb,WAAW,EAAErD,QAAQ,EAAEiB,wBAAwB,EAAEf,QAAQ,EAAE8B,MAAM,EAAEO,QAAQ,EAAEJ,KAAK,CAAC,CAAC;EACxF,IAAIiD,IAAI,GAAGjJ,WAAW,CAAC,YAAY;IACjC,OAAOoG,QAAQ,CAACK,OAAO,CAACwC,IAAI,CAAC,CAAC;EAChC,CAAC,EAAE,CAAC7C,QAAQ,CAAC,CAAC;EACd,IAAI8C,KAAK,GAAGlJ,WAAW,CAAC,YAAY;IAClC,OAAOoG,QAAQ,CAACK,OAAO,CAACyC,KAAK,CAAC,CAAC;EACjC,CAAC,EAAE,CAAC9C,QAAQ,CAAC,CAAC;EACd,IAAI+C,KAAK,GAAGnJ,WAAW,CAAC,UAAUoJ,KAAK,EAAE;IACvC,IAAIjD,WAAW,CAACM,OAAO,EAAE;MACvB,IAAI4C,YAAY,GAAGlD,WAAW,CAACM,OAAO,CAACa,qBAAqB,CAAC,CAAC;MAC9D,IAAIgC,OAAO,GAAG,CAACF,KAAK,CAACG,OAAO,GAAGF,YAAY,CAACG,IAAI,IAAIH,YAAY,CAACrD,KAAK;MACtEd,YAAY,CAACb,QAAQ,GAAGiF,OAAO,CAAC;IAClC;EACF,CAAC,EAAE,CAACjF,QAAQ,CAAC,CAAC;EACd,IAAIoF,IAAI,GAAGzJ,WAAW,CAAC,UAAUoJ,KAAK,EAAE;IACtC,IAAIjD,WAAW,CAACM,OAAO,EAAE;MACvB,IAAI4C,YAAY,GAAGlD,WAAW,CAACM,OAAO,CAACa,qBAAqB,CAAC,CAAC;MAC9D,IAAIgC,OAAO,GAAG,CAACF,KAAK,CAACG,OAAO,GAAGF,YAAY,CAACG,IAAI,IAAIH,YAAY,CAACrD,KAAK;MACtE,IAAI3B,QAAQ,EAAE+B,QAAQ,CAACK,OAAO,CAACvC,WAAW,GAAGG,QAAQ,GAAGiF,OAAO;IACjE;EACF,CAAC,EAAE,CAACjF,QAAQ,EAAE+B,QAAQ,CAAC,CAAC;EACxB,IAAIsD,WAAW,GAAG1J,WAAW,CAAC,YAAY;IACxC2F,cAAc,CAAC,IAAI,CAAC;IACpBS,QAAQ,CAACK,OAAO,CAACvC,WAAW,IAAIV,YAAY,IAAIE,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAACC,QAAQ;EAC/E,CAAC,EAAE,CAACpG,YAAY,EAAEE,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAACC,QAAQ,EAAExD,QAAQ,CAAC,CAAC;EAC3D,IAAIyD,YAAY,GAAG7J,WAAW,CAAC,YAAY;IACzC2F,cAAc,CAAC,IAAI,CAAC;IACpBS,QAAQ,CAACK,OAAO,CAACvC,WAAW,IAAIV,YAAY,IAAIE,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAACC,QAAQ;EAC/E,CAAC,EAAE,CAACpG,YAAY,EAAEE,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAACC,QAAQ,EAAExD,QAAQ,CAAC,CAAC;EAC3D,IAAI0D,MAAM,GAAG9J,WAAW,CAAC,YAAY;IACnCoG,QAAQ,CAACK,OAAO,CAACrB,MAAM,IAAI5D,WAAW;EACxC,CAAC,EAAE,CAAC4E,QAAQ,CAAC,CAAC;EACd,IAAI2D,OAAO,GAAG/J,WAAW,CAAC,YAAY;IACpCoG,QAAQ,CAACK,OAAO,CAACrB,MAAM,IAAI5D,WAAW;EACxC,CAAC,EAAE,CAAC4E,QAAQ,CAAC,CAAC;EACd,IAAI4D,YAAY,GAAGhK,WAAW,CAAC,UAAUiK,KAAK,EAAE;IAC9C,IAAItD,UAAU,GAAGP,QAAQ,CAACK,OAAO,CAACE,UAAU;IAC5C,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,UAAU,CAACrH,MAAM,EAAEsH,CAAC,IAAI,CAAC,EAAED,UAAU,CAACC,CAAC,CAAC,CAACC,IAAI,GAAGD,CAAC,KAAKqD,KAAK,GAAG,SAAS,GAAG,QAAQ;EACxG,CAAC,EAAE,CAAC7D,QAAQ,CAAC,CAAC;EACd,IAAI8D,UAAU,GAAGlK,WAAW,CAAC,YAAY;IACvC,IAAIwG,KAAK,GAAGJ,QAAQ,CAACK,OAAO;IAC5B,IAAID,KAAK,CAAC2D,iBAAiB,EAAE;MAC3B3D,KAAK,CAAC2D,iBAAiB,CAAC,CAAC;IAC3B,CAAC,MAAM,IAAI3D,KAAK,CAAC4D,mBAAmB,EAAE;MACpC5D,KAAK,CAAC4D,mBAAmB,CAAC,CAAC;IAC7B,CAAC,MAAM,IAAI5D,KAAK,CAAC6D,oBAAoB,EAAE;MACrC7D,KAAK,CAAC6D,oBAAoB,CAAC,CAAC;IAC9B,CAAC,MAAM,IAAI7D,KAAK,CAAC8D,uBAAuB,EAAE;MACxC9D,KAAK,CAAC8D,uBAAuB,CAAC,CAAC;IACjC,CAAC,MAAM;MACLC,OAAO,CAACC,IAAI,CAAC,0CAA0C,CAAC;IAC1D;EACF,CAAC,EAAE,CAACpE,QAAQ,CAAC,CAAC;EACd,IAAIqE,eAAe;EACnB,IAAInI,QAAQ,IAAI,IAAI,IAAIA,QAAQ,CAACiE,QAAQ,EAAE;IACzC,IAAImE,eAAe;IACnB,IAAIC,IAAI,GAAGrI,QAAQ,CAACiE,QAAQ,KAAK,MAAM;IACvC,IAAIqE,UAAU,GAAGD,IAAI,GAAGjH,KAAK,CAAC8C,KAAK,CAAClE,QAAQ,IAAIoB,KAAK,CAAC8C,KAAK,CAAClE,QAAQ,CAACsI,UAAU,IAAI;MACjFC,KAAK,EAAE,iBAAiB;MACxBC,OAAO,EAAE,QAAQ;MACjBC,IAAI,EAAE;IACR,CAAC,GAAGpD,SAAS;IACb,IAAIqD,SAAS,GAAGL,IAAI,KAAKjH,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACJ,KAAK,IAAI,MAAM,CAAC;IAC3D,IAAIK,aAAa,GAAGzJ,UAAU,CAACwD,SAAS,IAAIf,WAAW,IAAIG,QAAQ,CAAC;IACpE,IAAI8G,KAAK,GAAG;MACVC,aAAa,EAAE1H,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACI,aAAa;MAC9CC,SAAS,EAAE5H,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACM,SAAS;MACtCC,UAAU,EAAE9H,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACQ,UAAU;MACxCC,KAAK,EAAEhI,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAAC/B,KAAK;MAC9ByC,IAAI,EAAEjI,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAAChC,IAAI;MAC5B2C,YAAY,EAAElI,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACY,YAAY;MAC5CC,MAAM,EAAEpI,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAAC7F,MAAM;MAChC2G,WAAW,EAAErI,KAAK,CAAC8C,KAAK,CAACyE,KAAK,CAACe;IACjC,CAAC;IACD,IAAIC,eAAe,GAAGlI,QAAQ,CAACmI,GAAG,CAAC,UAAUC,OAAO,EAAElC,KAAK,EAAE;MAC3D,OAAO;QACLmC,IAAI,EAAED,OAAO,CAACnD,KAAK,GAAGrB,SAAS,GAAG,aAAa7H,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACC,aAAa,EAAE;UACtFP,KAAK,EAAEG;QACT,CAAC,CAAC;QACFhC,KAAK,EAAEmD,OAAO,CAACnD,KAAK;QACpBf,MAAM,EAAEkE,OAAO,CAAClE,MAAM;QACtBqE,SAAS,EAAEH,OAAO,CAACnD,KAAK,IAAIpF,MAAM,CAAC;UACjC2I,EAAE,EAAE,gBAAgB;UACpB7J,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACF8J,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;UAC1BxC,YAAY,CAACmC,OAAO,CAAClE,MAAM,GAAG,CAAC,CAAC,GAAGgC,KAAK,CAAC;UACzC,IAAIwC,eAAe,GAAG,EAAE;UACxB,KAAK,IAAI7F,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG7C,QAAQ,CAACzE,MAAM,EAAEsH,CAAC,IAAI,CAAC,EAAE;YAC3C6F,eAAe,CAAC1D,IAAI,CAAChF,QAAQ,CAAC6C,CAAC,CAAC,CAAC;YACjC;YACA,IAAIA,CAAC,KAAKqD,KAAK,IAAIwC,eAAe,CAAC7F,CAAC,CAAC,CAACqB,MAAM,EAAEwE,eAAe,CAAC7F,CAAC,CAAC,CAACqB,MAAM,GAAG,KAAK;YAC/E;YAAA,KACK,IAAIrB,CAAC,KAAKqD,KAAK,EAAEwC,eAAe,CAAC7F,CAAC,CAAC,CAACqB,MAAM,GAAG,CAAClE,QAAQ,CAACkG,KAAK,CAAC,CAAChC,MAAM;UAC3E;UACAjE,WAAW,CAACyI,eAAe,CAAC;QAC9B;MACF,CAAC;IACH,CAAC,CAAC;IACF,IAAIC,mBAAmB,GAAG;MACxBN,IAAI,EAAE,aAAatM,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACY,WAAW,EAAE;QACxDlB,KAAK,EAAEG;MACT,CAAC,CAAC;MACFsB,SAAS,EAAE1I,MAAM,CAAC;QAChB2I,EAAE,EAAE,yBAAyB;QAC7B7J,QAAQ,EAAEA;MACZ,CAAC,CAAC;MACFuF,MAAM,EAAEnD,wBAAwB;MAChC0H,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;QAC1B,OAAOzH,2BAA2B,CAAC,CAACD,wBAAwB,CAAC;MAC/D;IACF,CAAC;IACD,IAAI6H,cAAc,GAAG,CAAC,QAAQ,EAAE,cAAc,CAAC,CAACT,GAAG,CAAC,UAAUU,OAAO,EAAE;MACrE,OAAO;QACLR,IAAI,EAAEQ,OAAO,KAAK,QAAQ,GAAG,aAAa9M,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACW,MAAM,EAAE;UAC1EjB,KAAK,EAAEG;QACT,CAAC,CAAC,GAAG,aAAalL,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACS,YAAY,EAAE;UACxDf,KAAK,EAAEG;QACT,CAAC,CAAC;QACFsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAEK,OAAO,KAAK,QAAQ,GAAG,gBAAgB,GAAG,kBAAkB;UAChElK,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACF8J,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;UAC1B,IAAIpH,MAAM,IAAI,CAAC,GAAG5D,WAAW,IAAIoL,OAAO,KAAK,QAAQ,EAAE;YACrD,OAAO9C,MAAM,CAAC,CAAC;UACjB;UACA,IAAI1E,MAAM,IAAI5D,WAAW,IAAIoL,OAAO,KAAK,cAAc,EAAE;YACvD,OAAO7C,OAAO,CAAC,CAAC;UAClB;UACA,OAAOpC,SAAS;QAClB,CAAC;QACDkF,KAAK,EAAE;MACT,CAAC;IACH,CAAC,CAAC;IACF,IAAIC,WAAW,GAAG;MAChB/I,QAAQ,EAAEkI,eAAe;MACzBc,YAAY,EAAEL,mBAAmB;MACjCtH,MAAM,EAAEuH,cAAc;MACtBlB,UAAU,EAAE;QACVW,IAAI,EAAE,aAAatM,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACK,UAAU,EAAE;UACvDX,KAAK,EAAEG;QACT,CAAC,CAAC;QACFsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAE,kBAAkB;UACtB7J,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACF8J,OAAO,EAAEtC;MACX,CAAC;MACDhB,KAAK,EAAE;QACLkD,IAAI,EAAE,aAAatM,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACO,KAAK,EAAE;UAClDb,KAAK,EAAEG;QACT,CAAC,CAAC;QACFsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAE,mBAAmB;UACvB7J,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACFsK,QAAQ,EAAE,CAACrI,OAAO;QAClB6H,OAAO,EAAEtD;MACX,CAAC;MACDD,IAAI,EAAE;QACJmD,IAAI,EAAE,aAAatM,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACQ,IAAI,EAAE;UACjDd,KAAK,EAAEG;QACT,CAAC,CAAC;QACFsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAE,kBAAkB;UACtB7J,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACFsK,QAAQ,EAAErI,OAAO;QACjB6H,OAAO,EAAEvD;MACX;IACF,CAAC;IACD,IAAIgE,iBAAiB,GAAG,EAAE;IAC1B,CAACvC,eAAe,GAAGpI,QAAQ,CAACgE,KAAK,KAAK,IAAI,IAAIoE,eAAe,CAACwB,GAAG,CAAC,UAAUgB,IAAI,EAAE;MAChF,IAAIA,IAAI,KAAK,QAAQ,EAAE;QACrBP,cAAc,CAACT,GAAG,CAAC,UAAUU,OAAO,EAAE;UACpC,OAAOK,iBAAiB,CAAClE,IAAI,CAAC6D,OAAO,CAAC;QACxC,CAAC,CAAC;QACF,OAAOjF,SAAS;MAClB;MACA,IAAIuF,IAAI,KAAK,UAAU,IAAI,OAAOJ,WAAW,CAACI,IAAI,CAAC,KAAK,QAAQ,EAAE;QAChE,KAAK,IAAItG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkG,WAAW,CAACI,IAAI,CAAC,CAAC5N,MAAM,EAAEsH,CAAC,IAAI,CAAC,EAAEqG,iBAAiB,CAAClE,IAAI,CAAC+D,WAAW,CAACI,IAAI,CAAC,CAACtG,CAAC,CAAC,CAAC;QAClG,OAAOe,SAAS;MAClB;MACA,IAAIuF,IAAI,KAAK,cAAc,EAAE;QAC3BD,iBAAiB,CAAClE,IAAI,CAAC+D,WAAW,CAACI,IAAI,CAAC,CAAC;QACzC,OAAOvF,SAAS;MAClB;MACA,IAAI,OAAOuF,IAAI,KAAK,QAAQ,EAAE;QAC5B,OAAOD,iBAAiB,CAAClE,IAAI,CAAC+D,WAAW,CAACI,IAAI,CAAC,CAAC;MAClD;MACA,OAAOD,iBAAiB,CAAClE,IAAI,CAACmE,IAAI,CAAC;IACrC,CAAC,CAAC;IACFzC,eAAe,GAAG,aAAa3K,KAAK,CAACuM,aAAa,CAAClL,mBAAmB,EAAE;MACtEwJ,IAAI,EAAEA,IAAI;MACV1C,MAAM,EAAE,CAAC1C,SAAS,IAAIjD,QAAQ,CAACiE,QAAQ,KAAK,OAAO,IAAIoE,IAAI,IAAIjF,WAAW;MAC1EyH,MAAM,EAAE,SAASA,MAAMA,CAAA,EAAG;QACxB,IAAI,CAACpM,aAAa,CAACmF,YAAY,CAACO,OAAO,CAAC,EAAEd,cAAc,CAAC,KAAK,CAAC;MACjE;IACF,CAAC,EAAE,aAAa7F,KAAK,CAACuM,aAAa,CAAC7L,GAAG,EAAE;MACvC4M,SAAS,EAAE,KAAK;MAChBC,KAAK,EAAE,QAAQ;MACfC,OAAO,EAAE,SAAS;MAClB1C,UAAU,EAAEA;IACd,CAAC,EAAE,aAAa9K,KAAK,CAACuM,aAAa,CAAC5L,MAAM,EAAE;MAC1C2L,IAAI,EAAEzH,OAAO,GAAG,aAAa7E,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACO,KAAK,EAAE;QAC5Db,KAAK,EAAEG,SAAS;QAChBsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAE,mBAAmB;UACvB7J,QAAQ,EAAEA;QACZ,CAAC;MACH,CAAC,CAAC,GAAG,aAAa5C,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACQ,IAAI,EAAE;QAChDd,KAAK,EAAEG,SAAS;QAChBsB,SAAS,EAAE1I,MAAM,CAAC;UAChB2I,EAAE,EAAE,kBAAkB;UACtB7J,QAAQ,EAAEA;QACZ,CAAC;MACH,CAAC,CAAC;MACF6K,cAAc,EAAE,YAAY;MAC5Bf,OAAO,EAAE7H,OAAO,GAAGuE,KAAK,GAAGD,IAAI;MAC/BuE,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;QAC1B,OAAO7H,cAAc,CAAC,IAAI,CAAC;MAC7B;IACF,CAAC,CAAC,EAAE,aAAa7F,KAAK,CAACuM,aAAa,CAAC7L,GAAG,EAAE;MACxC4M,SAAS,EAAE,KAAK;MAChBC,KAAK,EAAE,QAAQ;MACfI,IAAI,EAAE;IACR,CAAC,EAAE,aAAa3N,KAAK,CAACuM,aAAa,CAAC7L,GAAG,EAAE;MACvCiN,IAAI,EAAE;IACR,CAAC,EAAE,aAAa3N,KAAK,CAACuM,aAAa,CAACzL,KAAK,EAAE,IAAI,EAAE,aAAad,KAAK,CAACuM,aAAa,CAAC1L,KAAK,EAAE;MACvF,YAAY,EAAEiD,MAAM,CAAC;QACnB2I,EAAE,EAAE,qBAAqB;QACzB7J,QAAQ,EAAEA;MACZ,CAAC,CAAC;MACFkI,UAAU,EAAED,IAAI,GAAGjH,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,IAAIjG,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAAC3B,KAAK,IAAItE,KAAK,CAAC8C,KAAK,CAACmD,QAAQ,CAAC3B,KAAK,CAAC6C,KAAK,IAAI,QAAQ,GAAGlD,SAAS;MACjI+F,IAAI,EAAE,MAAM;MACZC,SAAS,EAAE,OAAO;MAClBC,MAAM,EAAE,CAAC;QACPC,KAAK,EAAErJ,gBAAgB,IAAI;MAC7B,CAAC;IACH,CAAC,CAAC,EAAE,aAAa1E,KAAK,CAACuM,aAAa,CAACjL,mBAAmB,EAAE;MACxD,YAAY,EAAEwC,MAAM,CAAC;QACnB2I,EAAE,EAAE,gBAAgB;QACpB7J,QAAQ,EAAEA;MACZ,CAAC,CAAC;MACFT,GAAG,EAAEkE,WAAW;MAChB2H,QAAQ,EAAE,CAAC;MACXC,IAAI,EAAE,QAAQ;MACdF,KAAK,EAAE5I,SAAS,GAAGrD,IAAI,CAACC,KAAK,CAACoD,SAAS,GAAGZ,QAAQ,GAAG,GAAG,CAAC,GAAGsD,SAAS;MACrEqG,WAAW,EAAE7E,KAAK;MAClB8E,YAAY,EAAE,SAASA,YAAYA,CAAA,EAAG;QACpC,OAAO/I,YAAY,CAACyC,SAAS,CAAC;MAChC,CAAC;MACD6E,OAAO,EAAE/C,IAAI;MACb+D,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;QAC1B,OAAO7H,cAAc,CAAC,IAAI,CAAC;MAC7B;IACF,CAAC,CAAC,CAAC,CAAC,EAAE,aAAa7F,KAAK,CAACuM,aAAa,CAAC7L,GAAG,EAAE;MAC1C0N,GAAG,EAAE;QACHC,UAAU,EAAE;MACd;IACF,CAAC,EAAE,aAAarO,KAAK,CAACuM,aAAa,CAACxL,IAAI,EAAE;MACxC4B,MAAM,EAAE;IACV,CAAC,EAAEyI,aAAa,CAAC,CAAC,CAAC,EAAE,aAAapL,KAAK,CAACuM,aAAa,CAAC3L,IAAI,EAAE;MAC1D0L,IAAI,EAAE,aAAatM,KAAK,CAACuM,aAAa,CAAClB,KAAK,CAACG,SAAS,EAAE;QACtDT,KAAK,EAAEG;MACT,CAAC,CAAC;MACFoD,SAAS,EAAE;QACTC,MAAM,EAAE,KAAK;QACbC,KAAK,EAAE;MACT,CAAC;MACDC,cAAc,EAAE3D,UAAU;MAC1BlI,QAAQ,EAAE;QACR8L,QAAQ,EAAE5K,MAAM,CAAC;UACf2I,EAAE,EAAE,gBAAgB;UACpB7J,QAAQ,EAAEA;QACZ,CAAC,CAAC;QACF+L,SAAS,EAAE7K,MAAM,CAAC;UAChB2I,EAAE,EAAE,iBAAiB;UACrB7J,QAAQ,EAAEA;QACZ,CAAC;MACH,CAAC;MACD4D,KAAK,EAAE,EAAE,CAACoI,MAAM,CAACzB,iBAAiB,CAAC;MACnCO,OAAO,EAAE,SAASA,OAAOA,CAAA,EAAG;QAC1B,OAAO7H,cAAc,CAAC,IAAI,CAAC;MAC7B;IACF,CAAC,CAAC,CAAC,CAAC;EACN;EACA,IAAIgJ,mBAAmB;EACvB,IAAI,CAACrM,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAACiE,QAAQ,MAAM,MAAM,EAAE;IAC9DoI,mBAAmB,GAAG;MACpBC,YAAY,EAAE,SAASA,YAAYA,CAAA,EAAG;QACpC,OAAOjJ,cAAc,CAAC,IAAI,CAAC;MAC7B,CAAC;MACDqI,WAAW,EAAE,SAASA,WAAWA,CAAA,EAAG;QAClC,OAAOrI,cAAc,CAAC,IAAI,CAAC;MAC7B,CAAC;MACDkJ,YAAY,EAAE,SAASA,YAAYA,CAAA,EAAG;QACpC,OAAOlJ,cAAc,CAAC,IAAI,CAAC;MAC7B;IACF,CAAC;EACH;EACA,IAAImJ,KAAK;EACT,IAAIrL,IAAI,CAACsL,GAAG,KAAK,SAAS,IAAI,CAACzM,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAACiE,QAAQ,MAAM,MAAM,EAAE;IACxF;IACA;IACA,IAAIP,KAAK,EAAE;MACT8I,KAAK,GAAG;QACN9I,KAAK,EAAEA;MACT,CAAC;IACH,CAAC,MAAM,IAAIH,MAAM,EAAE;MACjBiJ,KAAK,GAAG;QACNjJ,MAAM,EAAEA;MACV,CAAC;IACH;EACF;EACA,OAAO,aAAa/F,KAAK,CAACuM,aAAa,CAACvL,QAAQ,EAAE;IAChDkO,MAAM,EAAEnF,YAAY;IACpBoF,OAAO,EAAEvF;EACX,CAAC,EAAE,aAAa5J,KAAK,CAACuM,aAAa,CAACnL,oBAAoB,EAAEnC,QAAQ,CAAC;IACjEkD,GAAG,EAAEiE;EACP,CAAC,EAAEyI,mBAAmB,EAAE;IACtBzM,SAAS,EAAEA,SAAS;IACpBK,QAAQ,EAAEA,QAAQ;IAClBE,MAAM,EAAEA,MAAM;IACdqM,KAAK,EAAEA,KAAK;IACZhB,QAAQ,EAAE;EACZ,CAAC,CAAC,EAAE,aAAahO,KAAK,CAACuM,aAAa,CAACpL,WAAW,EAAElC,QAAQ,CAAC,CAAC,CAAC,EAAE0E,IAAI,EAAE;IACnExB,GAAG,EAAEmE,QAAQ;IACbvD,gBAAgB,EAAE,SAASA,gBAAgBA,CAACuG,KAAK,EAAE;MACjD,IAAI5C,KAAK,GAAGJ,QAAQ,CAACK,OAAO;MAC5BnC,WAAW,CAACkC,KAAK,CAACnC,QAAQ,CAAC;MAC3BI,mBAAmB,CAAC+B,KAAK,CAACtC,WAAW,GAAGsC,KAAK,CAACnC,QAAQ,GAAG,GAAG,CAAC;MAC7D,IAAIzB,iBAAiB,EAAEA,iBAAiB,CAACwG,KAAK,CAAC;IACjD,CAAC;IACDrG,OAAO,EAAE,SAASA,OAAOA,CAACqG,KAAK,EAAE;MAC/BxE,UAAU,CAAC,KAAK,CAAC;MACjB,IAAI9B,QAAQ,EAAEA,QAAQ,CAACsG,KAAK,CAAC;IAC/B,CAAC;IACDnG,OAAO,EAAE,SAASA,OAAOA,CAACmG,KAAK,EAAE;MAC/BxE,UAAU,CAAC,KAAK,CAAC;MACjB,IAAI5B,QAAQ,EAAEA,QAAQ,CAACoG,KAAK,CAAC;IAC/B,CAAC;IACDjG,MAAM,EAAE,SAASA,MAAMA,CAACiG,KAAK,EAAE;MAC7BxE,UAAU,CAAC,IAAI,CAAC;MAChBY,YAAY,CAAC,IAAI,CAAC;MAClB,IAAItC,OAAO,EAAEA,OAAO,CAACkG,KAAK,CAAC;IAC7B,CAAC;IACD/F,YAAY,EAAE,SAASA,YAAYA,CAAC+F,KAAK,EAAE;MACzC,IAAI5C,KAAK,GAAGJ,QAAQ,CAACK,OAAO;MAC5BtC,cAAc,CAACqC,KAAK,CAACtC,WAAW,CAAC;MACjCO,mBAAmB,CAAC+B,KAAK,CAACtC,WAAW,GAAGsC,KAAK,CAACnC,QAAQ,GAAG,GAAG,CAAC;MAC7D,IAAIjB,aAAa,EAAEA,aAAa,CAACgG,KAAK,CAAC;IACzC,CAAC;IACD7F,cAAc,EAAE,SAASA,cAAcA,CAAC6F,KAAK,EAAE;MAC7C/D,SAAS,CAACe,QAAQ,CAACK,OAAO,CAACrB,MAAM,CAAC;MAClC,IAAI9B,eAAe,EAAEA,eAAe,CAAC8F,KAAK,CAAC;IAC7C,CAAC;IACDjH,QAAQ,EAAEA,QAAQ,IAAI,KAAK;IAC3BK,IAAI,EAAEA,IAAI,IAAI;EAChB,CAAC,CAAC,EAAEJ,QAAQ,CAAC,EAAEqI,eAAe,CAAC,CAAC;AAClC,CAAC,CAAC;AACF1I,KAAK,CAACmN,WAAW,GAAG,OAAO;AAC3BnN,KAAK,CAACoN,SAAS,GAAG7N,cAAc;AAChC,SAASS,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}